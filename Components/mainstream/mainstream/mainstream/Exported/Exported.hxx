#include <ntddk.h>

/*????????????????????????????
??????????????????????????????
??????????????????????????????
??????????????????????????????
??????????????????????????????
??????????????????????????????
??????????????????????????????
??????????????????????????????
??????????????????????????????
??????????????????????????????
??????????????????????????????
????????????????

Do you love Israel???????????????
*/



namespace n_export_table {

	namespace n_typedef {
		typedef LPSTR(NTAPI* tPsGetProcessImageFileName)(PEPROCESS Process);
		typedef NTSTATUS(NTAPI* tPsLookupProcessByProcessId)(_In_ HANDLE ProcessId, _Out_ PEPROCESS* Process);
		typedef PVOID(NTAPI* tPsGetProcessSectionBaseAddress)(_In_ PEPROCESS Process);
		typedef NTSTATUS(NTAPI* tMmCopyVirtualMemory)(
			PEPROCESS SourceProcess,
			PVOID SourceAddress,
			PEPROCESS TargetProcess,
			PVOID TargetAddress,
			SIZE_T BufferSize,
			KPROCESSOR_MODE PreviousMode,
			PSIZE_T ReturnSize
			);
	}

	extern n_typedef::tPsLookupProcessByProcessId PsLookupProcessByProcessId;
	extern n_typedef::tPsGetProcessImageFileName PsGetProcessImageFileName;
	extern n_typedef::tPsGetProcessSectionBaseAddress PsGetProcessSectionBaseAddress;
	extern n_typedef::tMmCopyVirtualMemory MmCopyVirtualMemory;

	NTSTATUS AutoResolveExports();
}